{"version":3,"sources":["../../../src/react-router/lib/Router.js"],"names":["propTypes","history","object","children","routes","render","func","createElement","onError","onUpdate","matchContext","Router","displayName","getDefaultProps","props","getInitialState","location","params","components","handleError","error","call","createRouterObject","state","router","transitionManager","createTransitionManager","getCurrentLocation","componentWillMount","_unlisten","listen","setState","componentWillReceiveProps","nextProps","componentWillUnmount","Object","keys","forEach","propType"],"mappings":"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","file":"Router.js","sourcesContent":["import invariant from 'invariant'\nimport React from 'react'\nimport createReactClass from 'create-react-class'\nimport { func, object } from 'prop-types'\n\nimport createTransitionManager from './createTransitionManager'\nimport { routes } from './InternalPropTypes'\nimport RouterContext from './RouterContext'\nimport { createRoutes } from './RouteUtils'\nimport { createRouterObject, assignRouterState } from './RouterUtils'\nimport warning from './routerWarning'\n\nconst propTypes = {\n  history: object,\n  children: routes,\n  routes, // alias for children\n  render: func,\n  createElement: func,\n  onError: func,\n  onUpdate: func,\n\n  // PRIVATE: For client-side rehydration of server match.\n  matchContext: object\n}\n\n/**\n * A <Router> is a high-level API for automatically setting up\n * a router that renders a <RouterContext> with all the props\n * it needs each time the URL changes.\n */\nconst Router = createReactClass({\n  displayName: 'Router',\n\n  propTypes,\n\n  getDefaultProps() {\n    return {\n      render(props) {\n        return <RouterContext {...props} />\n      }\n    }\n  },\n\n  getInitialState() {\n    return {\n      location: null,\n      routes: null,\n      params: null,\n      components: null\n    }\n  },\n\n  handleError(error) {\n    if (this.props.onError) {\n      this.props.onError.call(this, error)\n    } else {\n      // Throw errors by default so we don't silently swallow them!\n      throw error // This error probably occurred in getChildRoutes or getComponents.\n    }\n  },\n\n  createRouterObject(state) {\n    const { matchContext } = this.props\n    if (matchContext) {\n      return matchContext.router\n    }\n\n    const { history } = this.props\n    return createRouterObject(history, this.transitionManager, state)\n  },\n\n  createTransitionManager() {\n    const { matchContext } = this.props\n    if (matchContext) {\n      return matchContext.transitionManager\n    }\n\n    const { history } = this.props\n    const { routes, children } = this.props\n\n    invariant(\n      history.getCurrentLocation,\n      'You have provided a history object created with history v4.x or v2.x ' +\n        'and earlier. This version of React Router is only compatible with v3 ' +\n        'history objects. Please change to history v3.x.'\n    )\n\n    return createTransitionManager(\n      history,\n      createRoutes(routes || children)\n    )\n  },\n\n  componentWillMount() {\n    this.transitionManager = this.createTransitionManager()\n    this.router = this.createRouterObject(this.state)\n\n    this._unlisten = this.transitionManager.listen((error, state) => {\n      if (error) {\n        this.handleError(error)\n      } else {\n        // Keep the identity of this.router because of a caveat in ContextUtils:\n        // they only work if the object identity is preserved.\n        assignRouterState(this.router, state)\n        this.setState(state, this.props.onUpdate)\n      }\n    })\n  },\n\n  /* istanbul ignore next: sanity check */\n  componentWillReceiveProps(nextProps) {\n    warning(\n      nextProps.history === this.props.history,\n      'You cannot change <Router history>; it will be ignored'\n    )\n\n    warning(\n      (nextProps.routes || nextProps.children) ===\n        (this.props.routes || this.props.children),\n      'You cannot change <Router routes>; it will be ignored'\n    )\n  },\n\n  componentWillUnmount() {\n    if (this._unlisten)\n      this._unlisten()\n  },\n\n  render() {\n    const { location, routes, params, components } = this.state\n    const { createElement, render, ...props } = this.props\n\n    if (location == null)\n      return null // Async match\n\n    // Only forward non-Router-specific props to routing context, as those are\n    // the only ones that might be custom routing context props.\n    Object.keys(propTypes).forEach(propType => delete props[propType])\n\n    return render({\n      ...props,\n      router: this.router,\n      location,\n      routes,\n      params,\n      components,\n      createElement\n    })\n  }\n\n})\n\nexport default Router\n"]}