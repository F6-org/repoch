{"version":3,"sources":["../../src/create-backgroud-tasks/index.js"],"names":["createBackgroundTask","tasks","isRequestIdleCallbackScheduled","schedulePendingEvents","processPendingAnalyticsEvents","deadline","timeRemaining","length","task","pop","push"],"mappings":";;;;;kBA4BwBA,oB;;AA5BxB;;;;AACA;;;;;;AAEA,IAAIC,QAAQ,EAAZ;AACA,IAAIC,iCAAiC,KAArC;;AAEA,SAASC,qBAAT,GAAiC;AAC7B;AACA,QAAID,8BAAJ,EAAoC;;AAEpCA,qCAAiC,IAAjC;AACA,yBAAIE,6BAAJ;AACH;;AAED,SAASA,6BAAT,CAAuCC,QAAvC,EAAiD;AAC7C;AACA,WAAOA,SAASC,aAAT,KAA2B,CAA3B,IAAgCL,MAAMM,MAAN,GAAe,CAAtD,EAAyD;AACrD,YAAIC,OAAOP,MAAMQ,GAAN,EAAX;AACAD;AACH;;AAED;AACAN,qCAAiC,KAAjC;;AAEA;AACA,QAAID,MAAMM,MAAN,GAAe,CAAnB,EAAsBJ;AACzB;;AAEc,SAASH,oBAAT,CAA8BQ,IAA9B,EAAoC;AAC/C,QAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AAC5B,+BAAQ,KAAR;AACA;AACH;;AAEDP,UAAMS,IAAN,CAAWF,IAAX;AACAL;AACH","file":"index.js","sourcesContent":["import rIC from '../dom-helper/ric/index';\nimport warning from 'warning';\n\nlet tasks = [];\nlet isRequestIdleCallbackScheduled = false;\n\nfunction schedulePendingEvents() {\n    // Only schedule the rIC if one has not already been set.\n    if (isRequestIdleCallbackScheduled) return;\n\n    isRequestIdleCallbackScheduled = true;\n    rIC(processPendingAnalyticsEvents);\n}\n\nfunction processPendingAnalyticsEvents(deadline) {\n    // Go for as long as there is time remaining and work to do.\n    while (deadline.timeRemaining() > 0 && tasks.length > 0) {\n        let task = tasks.pop();\n        task();\n    }\n\n    // Reset the boolean so future rICs can be set.\n    isRequestIdleCallbackScheduled = false;\n\n    // Check if there are more events still to send.\n    if (tasks.length > 0) schedulePendingEvents();\n}\n\nexport default function createBackgroundTask(task) {\n    if (typeof task !== 'function') {\n        warning(false, `[createBackgroundTask] must has a function as argument`);\n        return;\n    }\n\n    tasks.push(task);\n    schedulePendingEvents();\n}\n\n"]}