{"version":3,"sources":["../../../../../src/node_modules/@concordance/react/lib/elementFactory.js"],"names":["arrify","require","diffShallow","escapeText","factory","api","reactTags","tag","Symbol","customPropertyFormatter","theme","indent","key","value","separator","react","attribute","openBracket","isSingle","withFirstPrefixed","formatAsKey","withLastPostfixed","closeBracket","lineBuilder","first","concat","increase","stripFlags","append","last","themeProperty","property","increaseValueIndent","customFormat","themeStringProperty","after","string","line","customItemFormatter","child","themeChild","item","themeReactChild","themeStringChild","describe","props","element","type","hasTypeFn","typeFn","name","displayName","children","properties","hasProperties","Object","keys","length","DescribedElementValue","isList","deserialize","state","recursor","DeserializedElementValue","ElementValue","hasChildren","expected","SHALLOW_EQUAL","UNEQUAL","formatted","wrapFromTheme","tagName","functionType","childBuffer","buffer","propertyBuffer","origin","isItem","finalize","formatName","openTag","single","start","selfCloseVoid","end","innerIndentation","result","selfClose","closeTag","maxDepth","str","shouldFormat","subject","isProperty","increaseIndent","compareResult","ObjectValue","defineProperty","prototype","modifyThemes","mapRecursor","modifier","next","descriptorTags","primitiveItem","complexItem","has","primitiveProperty","includesLinebreaks","modifyTheme","DescribedMixin","base","sort","size","index","describeProperty","describeAny","current","descriptor","describeItem","DeserializedMixin","module","exports"],"mappings":"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","file":"elementFactory.js","sourcesContent":["'use strict'\n\nconst arrify = require('arrify')\nconst diffShallow = require('./diffShallow')\nconst escapeText = require('./escapeText')\n\nfunction factory (api, reactTags) {\n  const tag = Symbol('@concordance/react.ElementValue')\n\n  function customPropertyFormatter (theme, indent, key, value) {\n    const separator = theme.react.attribute.separator + theme.react.attribute.value.openBracket\n    if (value.isSingle) {\n      return value\n        .withFirstPrefixed(key.formatAsKey(theme) + separator)\n        .withLastPostfixed(theme.react.attribute.value.closeBracket)\n    }\n\n    return api.lineBuilder.first(key.formatAsKey(theme) + separator)\n      .concat(value.withFirstPrefixed(indent.increase()).stripFlags())\n      .append(api.lineBuilder.last(indent + theme.react.attribute.value.closeBracket))\n  }\n\n  function themeProperty (theme) {\n    theme.property.increaseValueIndent = true\n    theme.property.customFormat = customPropertyFormatter\n  }\n\n  function themeStringProperty (theme) {\n    theme.property.separator = theme.react.attribute.separator\n    theme.property.after = ''\n    Object.assign(theme.string.line, theme.react.attribute.value.string.line)\n  }\n\n  function customItemFormatter (theme, indent, value) {\n    if (value.isSingle) {\n      return value\n        .withFirstPrefixed(theme.react.child.openBracket)\n        .withLastPostfixed(theme.react.child.closeBracket)\n    }\n\n    return api.lineBuilder.first(theme.react.child.openBracket)\n      .concat(value.withFirstPrefixed(indent.increase()).stripFlags())\n      .append(api.lineBuilder.last(indent + theme.react.child.closeBracket))\n  }\n\n  function themeChild (theme) {\n    theme.item.increaseValueIndent = true\n    theme.item.customFormat = customItemFormatter\n  }\n\n  function themeReactChild (theme) {\n    theme.item.after = ''\n  }\n\n  function themeStringChild (theme) {\n    theme.item.after = ''\n    Object.assign(theme.string, theme.react.child.string)\n  }\n\n  function describe (props) {\n    const element = props.value\n\n    const type = element.type\n    const hasTypeFn = typeof type === 'function'\n    const typeFn = hasTypeFn ? type : null\n    const name = hasTypeFn ? type.displayName || type.name : type\n\n    const children = arrify(element.props.children)\n\n    const properties = Object.assign({}, element.props)\n    delete properties.children\n    if (element.key !== null) {\n      properties.key = element.key\n    }\n    const hasProperties = Object.keys(properties).length > 0\n\n    return new DescribedElementValue(Object.assign({\n      children,\n      hasProperties,\n      hasTypeFn,\n      name,\n      properties,\n      typeFn,\n      isList: children.length > 0\n    }, props))\n  }\n\n  function deserialize (state, recursor) {\n    return new DeserializedElementValue(state, recursor)\n  }\n\n  class ElementValue extends api.ObjectValue {\n    constructor (props) {\n      super(props)\n      this.name = props.name\n      this.hasProperties = props.hasProperties\n      this.hasTypeFn = props.hasTypeFn\n\n      this.hasChildren = this.isList\n    }\n\n    compare (expected) {\n      return this.tag === expected.tag && this.name === expected.name\n        ? api.SHALLOW_EQUAL\n        : api.UNEQUAL\n    }\n\n    formatName (theme) {\n      const formatted = api.wrapFromTheme(theme.react.tagName, this.name)\n      return this.hasTypeFn\n        ? formatted + theme.react.functionType\n        : formatted\n    }\n\n    compareNames (expected) {\n      return this.name === expected.name && this.hasTypeFn === expected.hasTypeFn\n    }\n\n    formatShallow (theme, indent) {\n      const childBuffer = api.lineBuilder.buffer()\n      const propertyBuffer = api.lineBuilder.buffer()\n\n      return {\n        append (formatted, origin) {\n          if (origin.isItem === true) {\n            childBuffer.append(formatted)\n          } else {\n            propertyBuffer.append(formatted)\n          }\n        },\n\n        finalize: () => {\n          const name = this.formatName(theme)\n          const openTag = theme.react.openTag\n\n          if (!this.hasChildren && !this.hasProperties) {\n            return api.lineBuilder.single(openTag.start + name + openTag.selfCloseVoid + openTag.end)\n          }\n\n          const innerIndentation = indent.increase()\n          const children = childBuffer.withFirstPrefixed(innerIndentation).stripFlags()\n          const properties = propertyBuffer.withFirstPrefixed(innerIndentation).stripFlags()\n\n          const result = api.lineBuilder.buffer()\n          if (this.hasProperties) {\n            result\n              .append(api.lineBuilder.first(openTag.start + name))\n              .append(properties)\n\n            if (this.hasChildren) {\n              result.append(api.lineBuilder.line(indent + openTag.end))\n            } else {\n              result.append(api.lineBuilder.last(indent + openTag.selfClose + openTag.end))\n            }\n          } else {\n            result.append(api.lineBuilder.first(openTag.start + name + openTag.end))\n          }\n\n          if (this.hasChildren) {\n            result\n              .append(children)\n              .append(api.lineBuilder.last(indent + api.wrapFromTheme(theme.react.closeTag, name)))\n          }\n\n          return result\n        },\n\n        maxDepth: () => {\n          const name = this.formatName(theme)\n          const openTag = theme.react.openTag\n\n          if (!this.hasChildren && !this.hasProperties) {\n            return api.lineBuilder.single(openTag.start + name + openTag.selfCloseVoid + openTag.end)\n          }\n\n          let str = openTag.start + name\n          if (this.hasProperties) {\n            str += theme.maxDepth\n            if (this.hasChildren) {\n              str += openTag.end\n            } else {\n              str += ' ' + openTag.selfClose + openTag.end\n            }\n          } else {\n            str += openTag.end\n          }\n\n          if (this.hasChildren) {\n            str += theme.maxDepth + api.wrapFromTheme(theme.react.closeTag, name)\n          }\n\n          return api.lineBuilder.single(str)\n        },\n\n        shouldFormat (subject) {\n          return subject.isItem === true || subject.isProperty === true\n        },\n\n        increaseIndent: true\n      }\n    }\n\n    prepareDiff (expected) {\n      return {\n        compareResult: this.tag === expected.tag\n          ? api.SHALLOW_EQUAL\n          : api.UNEQUAL\n      }\n    }\n\n    diffShallow (expected, theme, indent) {\n      return diffShallow(api, this, expected, theme, indent)\n    }\n\n    serialize () {\n      return [this.name, this.hasProperties, this.hasTypeFn, super.serialize()]\n    }\n  }\n  Object.defineProperty(ElementValue.prototype, 'tag', {value: tag})\n\n  function modifyThemes (recursor) {\n    return api.mapRecursor(recursor, next => {\n      let modifier\n      if (next.isItem === true) {\n        if (next.tag === api.descriptorTags.primitiveItem && next.value.tag === api.descriptorTags.string) {\n          modifier = themeStringChild\n        } else if (next.tag === api.descriptorTags.complexItem && reactTags.has(next.value.tag)) {\n          modifier = themeReactChild\n        } else {\n          modifier = themeChild\n        }\n      } else if (next.isProperty === true) {\n        if (\n          next.tag === api.descriptorTags.primitiveProperty &&\n          next.value.tag === api.descriptorTags.string &&\n          !next.value.includesLinebreaks\n        ) {\n          modifier = themeStringProperty\n        } else {\n          modifier = themeProperty\n        }\n      }\n\n      return modifier\n        ? api.modifyTheme(next, modifier)\n        : next\n    })\n  }\n\n  function DescribedMixin (base) {\n    return class extends api.DescribedMixin(base) {\n      constructor (props) {\n        super(props)\n        this.children = props.children\n        this.properties = props.properties\n        this.typeFn = props.typeFn\n      }\n\n      compare (expected) {\n        const result = super.compare(expected)\n        return result === api.SHALLOW_EQUAL && this.typeFn !== expected.typeFn\n          ? api.UNEQUAL\n          : result\n      }\n\n      compareNames (expected) {\n        return super.compareNames(expected) && this.typeFn === expected.typeFn\n      }\n\n      createPropertyRecursor () {\n        // Symbols are not valid property keys for React elements. This code\n        // also assumes that the keys can be formatted as JSX-like attribute\n        // names. Keys are not pre-escaped before being passed to Concordance's\n        // property descriptor.\n        const keys = Object.keys(this.properties).sort()\n        const size = keys.length\n\n        let index = 0\n        const next = () => {\n          if (index === size) return null\n\n          const key = keys[index++]\n          // Note that string values are not specifically escaped such that the\n          // output is valid JSX.\n          return this.describeProperty(key, this.describeAny(this.properties[key]))\n        }\n\n        return {size, next}\n      }\n\n      createListRecursor () {\n        if (!this.isList) return super.createListRecursor()\n\n        const size = this.children.length\n\n        let index = 0\n        const next = () => {\n          if (index === size) return null\n\n          const current = index++\n          const child = this.children[current]\n          const type = typeof child\n          let descriptor\n          if (type === 'string') {\n            descriptor = this.describeAny(escapeText(child))\n          } else {\n            descriptor = this.describeAny(child)\n          }\n\n          return this.describeItem(current, descriptor)\n        }\n\n        return {size, next}\n      }\n\n      createRecursor () {\n        return modifyThemes(super.createRecursor())\n      }\n    }\n  }\n\n  function DeserializedMixin (base) {\n    return class extends api.DeserializedMixin(base) {\n      constructor (state, recursor) {\n        super(state[3], recursor)\n        this.name = state[0]\n        this.hasProperties = state[1]\n        this.hasTypeFn = state[2]\n      }\n\n      createRecursor () {\n        return modifyThemes(super.createRecursor())\n      }\n    }\n  }\n\n  const DescribedElementValue = DescribedMixin(ElementValue)\n  const DeserializedElementValue = DeserializedMixin(ElementValue)\n\n  return {\n    DescribedMixin,\n    DeserializedMixin,\n    ElementValue,\n    describe,\n    deserialize,\n    tag\n  }\n}\nmodule.exports = factory\n"]}