{"version":3,"sources":["../../src/weibo-image/index.js"],"names":["isValidPicID","getImgURL","getImageFormat","getImgGeometry","getImgLargeFileSize","pid","String","len","length","pat","test","type","url","zone","ext","parseInt","substr","geo","Object","width","height","size","dn","base","exp","rem"],"mappings":";;;;;QAEgBA,Y,GAAAA,Y;kBAQQC,S;QAkBRC,c,GAAAA,c;QAKAC,c,GAAAA,c;QAaAC,mB,GAAAA,mB;;AA9ChB;;;;;;AAEO,SAASJ,YAAT,CAAsBK,GAAtB,EAA2B;AAC9BA,UAAMC,OAAOD,GAAP,CAAN;AACAE,UAAMF,IAAIG,MAAV;;AAEA,QAAIC,MAAM,sBAAV;AACA,WAAOA,IAAIC,IAAJ,CAASL,GAAT,CAAP;AACH;;AAEc,SAASJ,SAAT,CAAmBI,GAAnB,EAAwBM,IAAxB,EAA8B;AACzC,QAAI,CAACN,GAAL,EAAU,OAAO,EAAP;;AAEV,QAAIO,GAAJ;AACA,QAAI,OAAOD,IAAP,IAAgB,WAApB,EAAiCA,OAAK,OAAL;AACjC,QAAIN,IAAI,CAAJ,KAAU,GAAV,IAAkBA,IAAI,CAAJ,KAAU,GAAV,IAAiBA,IAAIG,MAAJ,IAAc,EAArD,EAA0D;AACtD,YAAIK,OAAO,CAAC,mBAAMR,GAAN,IAAa,CAAd,IAAmB,CAA9B;AACA,YAAIS,MAAOT,IAAI,EAAJ,KAAW,GAAZ,GAAmB,KAAnB,GAA2B,KAArC;AACAO,cAAMP,IAAI,CAAJ,KAAU,GAAV,GAAe,SAAOQ,IAAP,GAAY,cAAZ,GAA2BF,IAA3B,GAAgC,GAAhC,GAAoCN,GAApC,GAAwC,GAAxC,GAA4CS,GAA3D,GACU,SAAOD,IAAP,GAAY,cAAZ,GAA2BF,IAA3B,GAAgC,GAAhC,GAAoCN,GAApC,GAAwC,GAAxC,GAA4CS,GAD5D;AAEH,KALD,MAKO;AACH,YAAID,OAAO,CAACE,SAASV,IAAIW,MAAJ,CAAW,CAAC,CAAZ,EAAe,CAAf,CAAT,EAA4B,EAA5B,IAAkC,GAAnC,IAA0C,CAArD;AACAJ,cAAM,SAAOC,IAAP,GAAY,cAAZ,GAA2BF,IAA3B,GAAgC,GAAhC,GAAoCN,GAApC,GAAwC,MAA9C;AACH;;AAED,WAAOO,GAAP;AACH;;AAEM,SAASV,cAAT,CAAwBG,GAAxB,EAA6B;AAChC,QAAIS,MAAOT,IAAI,EAAJ,KAAW,GAAZ,GAAmB,KAAnB,GAA2B,KAArC;AACA,WAAOS,GAAP;AACH;;AAEM,SAASX,cAAT,CAAwBE,GAAxB,EAA6B;AAChCA,UAAMC,OAAOD,GAAP,CAAN;AACA,QAAIY,GAAJ;;AAEA,QAAIZ,IAAIG,MAAJ,IAAc,EAAd,IAAoBH,IAAI,EAAJ,KAAS,GAAjC,EAAsC;AAClCY,cAAM,IAAIC,MAAJ,EAAN;AACAD,YAAIE,KAAJ,GAAYJ,SAASV,IAAIW,MAAJ,CAAW,EAAX,EAAe,CAAf,CAAT,EAA4B,EAA5B,CAAZ;AACAC,YAAIG,MAAJ,GAAaL,SAASV,IAAIW,MAAJ,CAAW,EAAX,EAAe,CAAf,CAAT,EAA4B,EAA5B,CAAb;AACH;;AAED,WAAOC,GAAP;AACH;;AAEM,SAASb,mBAAT,CAA6BC,GAA7B,EAAkC;AACrC,QAAIgB,OAAO,CAAX;AACAhB,UAAMC,OAAOD,GAAP,CAAN;;AAEA,QAAIA,IAAIG,MAAJ,IAAc,EAAd,IAAoBH,IAAI,EAAJ,KAAW,GAAnC,EAAwC;AACpCiB,aAAKP,SAASV,IAAIW,MAAJ,CAAW,EAAX,EAAe,CAAf,CAAT,EAA4B,EAA5B,CAAL;AACAO,eAAOD,KAAK,KAAZ;AACAE,cAAOF,OAAK,EAAN,GAAY,GAAlB;AACAG,cAAOH,OAAK,EAAN,GAAY,GAAlB;;AAEAD,eAAQE,IAAD,IAAWC,MAAM,EAAxB;AACAH,gBAAUI,MAAI,EAAL,IAAY,CAACD,MAAI,CAAJ,GAAOA,MAAI,CAAX,GAAcA,GAAf,IAAoB,EAAzC;AACH;AACD,WAAOH,IAAP;AACH","file":"index.js","sourcesContent":["import crc32 from './crc32';\n \nexport function isValidPicID(pid) {\n    pid = String(pid);\n    len = pid.length;\n\n    var pat = /^[0-9a-zA-Z]{21,40}$/;\n    return pat.test(pid);\n}\n\nexport default function getImgURL(pid, type) {\n    if (!pid) return '';\n\n    var url;\n    if (typeof(type) == \"undefined\") type='large';\n    if (pid[9] == 'w' || (pid[9] == 'y' && pid.length >= 32)) {\n        var zone = (crc32(pid) & 3) + 1;\n        var ext = (pid[21] == 'g') ? 'gif' : 'jpg';\n        url = pid[9] == 'w'? '//ww'+zone+'.sinaimg.cn/'+type+'/'+pid+'.'+ext:\n                        '//wx'+zone+'.sinaimg.cn/'+type+'/'+pid+'.'+ext;\n    } else {\n        var zone = (parseInt(pid.substr(-2, 2), 16) & 0xf) + 1;\n        url = '//ss'+zone+'.sinaimg.cn/'+type+'/'+pid+'&690';\n    }\n\n    return url;\n}\n\nexport function getImageFormat(pid) {\n    var ext = (pid[21] == 'g') ? 'gif' : 'jpg';\n    return ext;\n}\n\nexport function getImgGeometry(pid) {\n    pid = String(pid);\n    var geo;\n\n    if (pid.length >= 32 && pid[22]>='1') {\n        geo = new Object();\n        geo.width = parseInt(pid.substr(23, 3), 36);\n        geo.height = parseInt(pid.substr(26, 3), 36);\n    }\n\n    return geo;\n}\n\nexport function getImgLargeFileSize(pid) {\n    var size = 0;\n    pid = String(pid);\n\n    if (pid.length >= 32 && pid[22] >= '2') {\n        dn = parseInt(pid.substr(29, 3), 36);\n        base = dn & 0x3FF;\n        exp = (dn>>>10) & 0x3;\n        rem = (dn>>>12) & 0xf;\n\n        size = (base) << (exp * 10);\n        size += ((rem*93) << (exp>0?(exp-1):exp)*10);\n    }\n    return size;\n}\n\n"]}