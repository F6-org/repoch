{"version":3,"sources":["../../src/weibo-jsbridge/set-menu-items.js"],"names":["opts","items","onSuccess","onFail","bridgeReady","window","WeiboJSBridge","invoke","params","success","code","document"],"mappings":";;;;;;kQAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBA0Ce,UAASA,IAAT,EAAe;AAC1BA,WAAO,SAAc;AACjBC,eAAM,EADW;AAEjBC,mBAAW,qBAAW,CAAE,CAFP;AAGjBC,gBAAQ,kBAAW,CAAE;AAHJ,KAAd,EAIJH,IAJI,CAAP;;AAMA,QAAII,cAAc,SAAdA,WAAc,GAAW;AACzBC,eAAOC,aAAP,CAAqBC,MAArB,CAA4B,cAA5B,EAA4C,EAACN,OAAOD,KAAKC,KAAb,EAA5C,EAAiE,UAASO,MAAT,EAAiBC,OAAjB,EAA0BC,IAA1B,EAAgC;AAC7F,gBAAID,OAAJ,EAAa;AACTT,qBAAKE,SAAL;AACH,aAFD,MAEO;AACHF,qBAAKG,MAAL,CAAYO,IAAZ;AACH;AACJ,SAND;AAOH,KARD;;AAUA,QAAI,CAACL,OAAOC,aAAZ,EAA2B;AACvBN,aAAKG,MAAL,CAAY,GAAZ;AACA,0BAAiBQ,QAAjB,EAA2B,oBAA3B,EAAiDP,WAAjD;AACA;AACH;;AAEDA;AACH,C;;AA1BD","file":"set-menu-items.js","sourcesContent":["/**\n * 设置浏览器右上角菜单内容\n * 仅 weibo.com、weibo.cn、sina.com、sina.com.cn 及其子域名可以调用\n * @param {Object} opts\n * @param {Array} opts.items - \n  {\n    title：按钮的标题\n    color：标题的颜色，目前只支持 red 或普通\n    scheme：点击跳转的地址，可以为 http(s)、sinaweibo scheme，http链接在当前页面跳转，sinaweibo链接在新界面打开。如果为空，点击不跳转。\n    code：item的标识码，可以为整数或字符串，可以和 menuItemSelected 事件配合使用\n  }\n * @param {Function} opts.onSuccess 执行成功回调\n * @param {Function} opts.onFail 执行失败回调\n * @example \n        var opts = {};\n        opts.items = [{\n            \"title\": \"打开发布器\", \"scheme\": \"sinaweibo://sendweibo\"\n        }, {\n            \"title\": \"跳转到 weibo.com\", \"scheme\": \"http://weibo.com\"\n        }, {\n            \"title\": title, \"color\": color, \"code\": redButtonCode\n        }, {\n            \"title\": \"恢复原始菜单\", \"code\": revertButtonCode\n        }, {\n            \"title\": \"关闭浏览器\", \"scheme\": \"sinaweibo://browser/close\", \"color\": \"red\"\n        }];\n        STK.utils.weiboJSBridge.setMenuItems(opts);\n * @weibo >=5.1.0\n * @Auther MrGalaxyn\n * 错误码\n    代码        Status Code           含义\n    200         OK                  操作成功\n    400         MISSING_PARAMS      缺少必须的参数\n    403         ILLEGAL_ACCESS      非法调用\n    500         INTERNAL_ERROR      客户端内部处理错误\n    501         ACTION_NOT_FOUND    客户端未实现此 action\n    550         NO_RESULT           客户端没有获取到结果\n    550         USER_CANCELLED      用户取消了操作\n    553         SERVICE_FORBIDDEN   相关服务未启用或被禁止 (如定位服务，相册权限)\n */\nimport addEventListener from 'dom-helpers/events/on';\n\nexport default function(opts) {\n    opts = Object.assign({\n        items:[],\n        onSuccess: function() {},\n        onFail: function() {}\n    }, opts);\n\n    var bridgeReady = function() {\n        window.WeiboJSBridge.invoke(\"setMenuItems\", {items: opts.items}, function(params, success, code) {\n            if (success) {\n                opts.onSuccess();\n            } else {\n                opts.onFail(code);\n            }\n        });\n    }\n\n    if (!window.WeiboJSBridge) {\n        opts.onFail(550);\n        addEventListener(document, 'WeiboJSBridgeReady', bridgeReady);\n        return;\n    }\n\n    bridgeReady();            \n}\n"]}