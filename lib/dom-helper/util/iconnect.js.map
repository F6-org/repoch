{"version":3,"sources":["../../../src/dom-helper/util/iconnect.js"],"names":["window","document","undefined","cEvt","isArray","o","Object","prototype","toString","call","getType","oObject","_t","slice","toLowerCase","custEventAttribute","custEventKey","custEventCache","findCache","obj","type","_key","key","hookCache","add","fn","data","once","_cache","push","fire","args","defaultAction","preventDefaultFlag","preventDefault","_obj","concat","i","length","isOnce","apply","splice","e","console","log","message","stack","that","define","undefine","remove","index","hook","orig","dest","typeMap","destTypes","origKey","origKeyCache","origTypeCache","destKey","keyHookCache","event","Array","arguments","origType","destType","unhook","destroy","utils","count","getUniqueKey","Date","Math","random","replace","json2str","f","n","toJSON","isFinite","valueOf","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","String","Number","Boolean","cx","escapable","gap","indent","meta","rep","quote","string","lastIndex","test","a","c","charCodeAt","str","holder","k","v","mind","partial","value","join","hasOwnProperty","replacer","space","JSON","stringify","Error","str2json","eval","getUrlParam","name","reg","RegExp","r","location","search","substr","match","unescape","iframeConnect","cidList","iid","post","cid","cmd","param","msg","parent","postMessage","navigator","listener","evt","rs","addEventListener","attachEvent","trigger","callback","toUpperCase","on","off","iconnect","setHeight","num","getLayoutInfo","oauth","options","appkey","doc","iframe_id","url","encodeURIComponent","getElementById","iframe","createElement","id","style","cssText","src","body","appendChild"],"mappings":"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","file":"iconnect.js","sourcesContent":["/*\n*  用于iframe内外通信。\n*  iconnect.trigger('insertIntoPublishTop', 'aaa', function(){'callback'});\n*/\n\n(function(window, document, undefined){\n\n\t//STK的自定义事件\n\tvar cEvt = (function(){\n\n\t\t//===自定义事件依赖关系===\n\t\tvar isArray = function(o){\n\t\t\treturn Object.prototype.toString.call(o) === '[object Array]';\n\t\t};\n\t\tvar getType = function(oObject){\n\t\t\tvar _t;\n\t\t\treturn ((_t = typeof(oObject)) == \"object\" ? oObject == null && \"null\" || Object.prototype.toString.call(oObject).slice(8, -1) : _t).toLowerCase();\n\t\t};\n\t\t//====================\n\n\t\tvar custEventAttribute = \"__custEventKey__\",\n\t\t\tcustEventKey = 1,\n\t\t\tcustEventCache = {},\n\t\t\t/**\n\t\t\t * 从缓存中查找相关对象 \n\t\t\t * 当已经定义时 \n\t\t\t * \t有type时返回缓存中的列表 没有时返回缓存中的对象\n\t\t\t * 没有定义时返回false\n\t\t\t * @param {Object|number} obj 对象引用或获取的key\n\t\t\t * @param {String} type 自定义事件名称\n\t\t\t */\n\t\t\tfindCache = function(obj, type) {\n\t\t\t\tvar _key = (typeof obj == \"number\") ? obj : obj[custEventAttribute];\n\t\t\t\treturn (_key && custEventCache[_key]) && {\n\t\t\t\t\tobj: (typeof type == \"string\" ? custEventCache[_key][type] : custEventCache[_key]),\n\t\t\t\t\tkey: _key\n\t\t\t\t};\n\t\t\t};\n\t\t////\n\t\t//事件迁移相关\n\t\tvar hookCache = {};//arr key -> {origtype-> {fn, desttype}}\n\t\t//\n\t\tvar add = function(obj, type, fn, data, once) {\n\t\t\tif(obj && typeof type == \"string\" && fn) {\n\t\t\t\tvar _cache = findCache(obj, type);\n\t\t\t\tif(!_cache || !_cache.obj) {\n\t\t\t\t\tthrow \"custEvent (\" + type + \") is undefined !\";\n\t\t\t\t}\n\t\t\t\t_cache.obj.push({fn: fn, data: data, once: once});\n\t\t\t\treturn _cache.key;\n\t\t\t}\n\t\t};\n\t\t\n\t\tvar fire = function(obj, type, args, defaultAction) {\n\t\t\t//事件默认行为阻止\n\t\t\tvar preventDefaultFlag = true;\n\t\t\tvar preventDefault = function() {\n\t\t\t\tpreventDefaultFlag = false;\n\t\t\t};\n\t\t\tif(obj && typeof type == \"string\") {\n\t\t\t\tvar _cache = findCache(obj, type), _obj;\n\t\t\t\tif (_cache && (_obj = _cache.obj)) {\n\t\t\t\t\targs = typeof args != 'undefined' && [].concat(args) || [];\n\t\t\t\t\tfor(var i = _obj.length - 1; i > -1 && _obj[i]; i--) {\n\t\t\t\t\t\tvar fn = _obj[i].fn;\n\t\t\t\t\t\tvar isOnce = _obj[i].once;\n\t\t\t\t\t\tif(fn && fn.apply) {\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tfn.apply(obj, [{obj: obj, type: type, data: _obj[i].data, preventDefault: preventDefault}].concat(args));\n\t\t\t\t\t\t\t\tif(isOnce){\n\t\t\t\t\t\t\t\t\t_obj.splice(i,1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\twindow.console && console.log(\"[error][custEvent]\" + e.message, e, e.stack);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif(preventDefaultFlag && getType(defaultAction) === 'function') {\n\t\t\t\t\t\tdefaultAction();\n\t\t\t\t\t}\n\t\t\t\t\treturn _cache.key;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\tvar that = {\n\t\t\t/**\n\t\t\t * 对象自定义事件的定义 未定义的事件不得绑定\n\t\t\t * @method define\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的下标(key); 必选 \n\t\t\t * @param {String|Array} type 自定义事件名称; 必选\n\t\t\t * @return {number} key 下标\n\t\t\t */\n\t\t\tdefine: function(obj, type) {\n\t\t\t\tif(obj && type) {\n\t\t\t\t\tvar _key = (typeof obj == \"number\") ? obj : obj[custEventAttribute] || (obj[custEventAttribute] = custEventKey++),\n\t\t\t\t\t\t_cache = custEventCache[_key] || (custEventCache[_key] = {});\n\t\t\t\t\ttype = [].concat(type);\n\t\t\t\t\tfor(var i = 0; i < type.length; i++) {\n\t\t\t\t\t\t_cache[type[i]] || (_cache[type[i]] = []);\n\t\t\t\t\t}\n\t\t\t\t\treturn _key;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 对象自定义事件的取消定义 \n\t\t\t * 当对象的所有事件定义都被取消时 删除对对象的引用\n\t\t\t * @method define\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的(key); 必选\n\t\t\t * @param {String} type 自定义事件名称; 可选 不填可取消所有事件的定义\n\t\t\t */\n\t\t\tundefine: function(obj, type) {\n\t\t\t\tif (obj) {\n\t\t\t\t\tvar _key = (typeof obj == \"number\") ? obj : obj[custEventAttribute];\n\t\t\t\t\tif (_key && custEventCache[_key]) {\n\t\t\t\t\t\tif (type) {\n\t\t\t\t\t\t\ttype = [].concat(type);\n\t\t\t\t\t\t\tfor(var i = 0; i < type.length; i++) {\n\t\t\t\t\t\t\t\tif (type[i] in custEventCache[_key]) delete custEventCache[_key][type[i]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete custEventCache[_key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 事件添加或绑定\n\t\t\t * @method add\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的(key); 必选\n\t\t\t * @param {String} type 自定义事件名称; 必选\n\t\t\t * @param {Function} fn 事件处理方法; 必选\n\t\t\t * @param {Any} data 扩展数据任意类型; 可选\n\t\t\t * @return {number} key 下标\n\t\t\t */\n\t\t\tadd: function(obj, type, fn, data) {\n\t\t\t\treturn add(obj, type, fn, data, false);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 单次事件绑定\n\t\t\t * @method once\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的(key); 必选\n\t\t\t * @param {String} type 自定义事件名称; 必选\n\t\t\t * @param {Function} fn 事件处理方法; 必选\n\t\t\t * @param {Any} data 扩展数据任意类型; 可选\n\t\t\t * @return {number} key 下标\n\t\t\t */\n\t\t\tonce: function(obj, type, fn, data) {\n\t\t\t\treturn add(obj, type, fn, data, true);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 事件删除或解绑\n\t\t\t * @method remove\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的(key); 必选\n\t\t\t * @param {String} type 自定义事件名称; 可选; 为空时删除对象下的所有事件绑定\n\t\t\t * @param {Function} fn 事件处理方法; 可选; 为空且type不为空时 删除对象下type事件相关的所有处理方法\n\t\t\t * @return {number} key 下标\n\t\t\t */\n\t\t\tremove: function(obj, type, fn) {\n\t\t\t\tif (obj) {\n\t\t\t\t\tvar _cache = findCache(obj, type), _obj, index;\n\t\t\t\t\tif (_cache && (_obj = _cache.obj)) {\n\t\t\t\t\t\tif (isArray(_obj)) {\n\t\t\t\t\t\t\tif (fn) {\n\t\t\t\t\t\t\t\t//for (var i = 0; i < _obj.length && _obj[i].fn !== fn; i++);\n\t\t\t\t\t\t\t\tvar i = 0;\n\t\t\t\t\t\t\t\twhile(_obj[i]) {\n\t\t\t\t\t\t\t\t\tif(_obj[i].fn === fn) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t_obj.splice(i, 1);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_obj.splice(0, _obj.length);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (var i in _obj) {\n\t\t\t\t\t\t\t\t_obj[i] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn _cache.key;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 事件触发\n\t\t\t * @method fire\n\t\t\t * @static\n\t\t\t * @param {Object|number} obj 对象引用或获取的(key); 必选\n\t\t\t * @param {String} type 自定义事件名称; 必选\n\t\t\t * @param {Any|Array} args 参数数组或单个的其他数据; 可选\n\t\t\t * @param {Function} defaultAction 触发事件列表结束后的默认Function; 可选 注：当args不需要时请用undefined/null填充,以保证该参数为第四个参数\n\t\t\t * @return {number} key 下标\n\t\t\t */\n\t\t\tfire: function(obj, type, args, defaultAction) {\n\t\t\t\treturn fire(obj, type, args, defaultAction);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 事件由源对象迁移到目标对象\n\t\t\t * @method hook\n\t\t\t * @static\n\t\t\t * @param {Object} orig 源对象\n\t\t\t * @param {Object} dest 目标对象\n\t\t\t * @param {Object} typeMap 事件名称对照表\n\t\t\t * {\n\t\t\t * \t源事件名->目标事件名\n\t\t\t * }\n\t\t\t */\n\t\t\thook: function(orig, dest, typeMap) {\n\t\t\t\tif(!orig || !dest || !typeMap) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar destTypes = [],\n\t\t\t\t\torigKey = orig[custEventAttribute],\n\t\t\t\t\torigKeyCache = origKey && custEventCache[origKey],\n\t\t\t\t\torigTypeCache,\n\t\t\t\t\tdestKey = dest[custEventAttribute] || (dest[custEventAttribute] = custEventKey++),\n\t\t\t\t\tkeyHookCache;\n\t\t\t\tif(origKeyCache) {\n\t\t\t\t\tkeyHookCache = hookCache[origKey +'_'+ destKey] || (hookCache[origKey +'_'+ destKey] = {});\n\t\t\t\t\tvar fn = function(event) {\n\t\t\t\t\t\tvar preventDefaultFlag = true;\n\t\t\t\t\t\tfire(dest, keyHookCache[event.type].type, Array.prototype.slice.apply(arguments, [1, arguments.length]), function() {\n\t\t\t\t\t\t\tpreventDefaultFlag = false\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpreventDefaultFlag && event.preventDefault();\n\t\t\t\t\t};\n\t\t\t\t\tfor(var origType in typeMap) {\n\t\t\t\t\t\tvar destType = typeMap[origType];\n\t\t\t\t\t\tif(!keyHookCache[origType]) {\n\t\t\t\t\t\t\tif(origTypeCache = origKeyCache[origType]) {\n\t\t\t\t\t\t\t\torigTypeCache.push({fn: fn, data: undefined});\n\t\t\t\t\t\t\t\tkeyHookCache[origType] = {\n\t\t\t\t\t\t\t\t\tfn: fn,\n\t\t\t\t\t\t\t\t\ttype: destType\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tdestTypes.push(destType);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthat.define(dest, destTypes);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 取消事件迁移\n\t\t\t * @method unhook\n\t\t\t * @static\n\t\t\t * @param {Object} orig 源对象\n\t\t\t * @param {Object} dest 目标对象\n\t\t\t * @param {Object} typeMap 事件名称对照表\n\t\t\t * {\n\t\t\t * \t源事件名->目标事件名\n\t\t\t * }\n\t\t\t */\n\t\t\tunhook: function(orig, dest, typeMap) {\n\t\t\t\tif(!orig || !dest || !typeMap) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar origKey = orig[custEventAttribute],\n\t\t\t\t\tdestKey = dest[custEventAttribute],\n\t\t\t\t\tkeyHookCache = hookCache[origKey +'_'+ destKey];\n\t\t\t\tif(keyHookCache) {\n\t\t\t\t\tfor (var origType in typeMap) {\n\t\t\t\t\t\tvar destType = typeMap[origType];\n\t\t\t\t\t\tif (keyHookCache[origType]) {\n\t\t\t\t\t\t\tthat.remove(orig, origType, keyHookCache[origType].fn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 销毁\n\t\t\t * @method destroy\n\t\t\t * @static\n\t\t\t */\n\t\t\tdestroy: function() {\n\t\t\t\tcustEventCache = {};\n\t\t\t\tcustEventKey = 1;\n\t\t\t\thookCache = {};\n\t\t\t}\n\t\t};\n\t\treturn that;\n\t})();\n\tvar utils = {\n\t\tcount: 0,\n\t\tgetUniqueKey: function(){\n\t\t\treturn +new Date() + (Math.random()+'').replace('.','') + utils.count++;\n\t\t},\n\t\tjson2str: (function(){\n\t\t\t\tfunction f(n){\n\t\t\t\t\t// Format integers to have at least two digits.\n\t\t\t\t\treturn n < 10 ? '0' + n : n;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (typeof Date.prototype.toJSON !== 'function') {\n\t\t\t\t\n\t\t\t\t\tDate.prototype.toJSON = function(key){\n\t\t\t\t\t\n\t\t\t\t\t\treturn isFinite(this.valueOf()) ? this.getUTCFullYear() + '-' + f(this.getUTCMonth() + 1) + '-' + f(this.getUTCDate()) + 'T' + f(this.getUTCHours()) + ':' + f(this.getUTCMinutes()) + ':' + f(this.getUTCSeconds()) + 'Z' : null;\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tString.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function(key){\n\t\t\t\t\t\treturn this.valueOf();\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g, escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g, gap, indent, meta = { // table of character substitutions\n\t\t\t\t\t'\\b': '\\\\b',\n\t\t\t\t\t'\\t': '\\\\t',\n\t\t\t\t\t'\\n': '\\\\n',\n\t\t\t\t\t'\\f': '\\\\f',\n\t\t\t\t\t'\\r': '\\\\r',\n\t\t\t\t\t'\"': '\\\\\"',\n\t\t\t\t\t'\\\\': '\\\\\\\\'\n\t\t\t\t}, rep;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfunction quote(string){\n\t\t\t\t\n\t\t\t\t\t// If the string contains no control characters, no quote characters, and no\n\t\t\t\t\t// backslash characters, then we can safely slap some quotes around it.\n\t\t\t\t\t// Otherwise we must also replace the offending characters with safe escape\n\t\t\t\t\t// sequences.\n\t\t\t\t\tescapable.lastIndex = 0;\n\t\t\t\t\treturn escapable.test(string) ? '\"' +\n\t\t\t\t\tstring.replace(escapable, function(a){\n\t\t\t\t\t\tvar c = meta[a];\n\t\t\t\t\t\treturn typeof c === 'string' ? c : '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n\t\t\t\t\t}) +\n\t\t\t\t\t'\"' : '\"' + string + '\"';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tfunction str(key, holder){\n\t\t\t\t\n\t\t\t\t\t// Produce a string from holder[key].\n\t\t\t\t\tvar i, // The loop counter.\n\t\t\t k, // The member key.\n\t\t\t v, // The member value.\n\t\t\t length, mind = gap, partial, value = holder[key];\n\t\t\t\t\t\n\t\t\t\t\t// If the value has a toJSON method, call it to obtain a replacement value.\n\t\t\t\t\tif (value && typeof value === 'object' && typeof value.toJSON === 'function') {\n\t\t\t\t\t\tvalue = value.toJSON(key);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// If we were called with a replacer function, then call the replacer to\n\t\t\t\t\t// obtain a replacement value.\n\t\t\t\t\tif (typeof rep === 'function') {\n\t\t\t\t\t\tvalue = rep.call(holder, key, value);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// What happens next depends on the value's type.\n\t\t\t\t\tswitch (typeof value) {\n\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\treturn quote(value);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// JSON numbers must be finite. Encode non-finite numbers as null.\n\t\t\t\t\t\t\treturn isFinite(value) ? String(value) : 'null';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\tcase 'null':\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// If the value is a boolean or null, convert it to a string. Note:\n\t\t\t\t\t\t\t// typeof null does not produce 'null'. The case is included here in\n\t\t\t\t\t\t\t// the remote chance that this gets fixed someday.\n\t\t\t\t\t\t\treturn String(value);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t// If the type is 'object', we might be dealing with an object or an array or\n\t\t\t\t\t\t// null.\n\t\t\t\t\t\tcase 'object':\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Due to a specification blunder in ECMAScript, typeof null is 'object',\n\t\t\t\t\t\t\t// so watch out for that case.\n\t\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\t\treturn 'null';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Make an array to hold the partial results of stringifying this object value.\n\t\t\t\t\t\t\tgap += indent;\n\t\t\t\t\t\t\tpartial = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Is the value an array?\n\t\t\t\t\t\t\tif (Object.prototype.toString.apply(value) === '[object Array]') {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// The value is an array. Stringify every element. Use null as a placeholder\n\t\t\t\t\t\t\t\t// for non-JSON values.\n\t\t\t\t\t\t\t\tlength = value.length;\n\t\t\t\t\t\t\t\tfor (i = 0; i < length; i += 1) {\n\t\t\t\t\t\t\t\t\tpartial[i] = str(i, value) || 'null';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Join all of the elements together, separated with commas, and wrap them in\n\t\t\t\t\t\t\t\t// brackets.\n\t\t\t\t\t\t\t\tv = partial.length === 0 ? '[]' : gap ? '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']' : '[' + partial.join(',') + ']';\n\t\t\t\t\t\t\t\tgap = mind;\n\t\t\t\t\t\t\t\treturn v;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// If the replacer is an array, use it to select the members to be stringified.\n\t\t\t\t\t\t\tif (rep && typeof rep === 'object') {\n\t\t\t\t\t\t\t\tlength = rep.length;\n\t\t\t\t\t\t\t\tfor (i = 0; i < length; i += 1) {\n\t\t\t\t\t\t\t\t\tk = rep[i];\n\t\t\t\t\t\t\t\t\tif (typeof k === 'string') {\n\t\t\t\t\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\t\t\t\t\tif (v) {\n\t\t\t\t\t\t\t\t\t\t\tpartial.push(quote(k) + (gap ? ': ' : ':') + v);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Otherwise, iterate through all of the keys in the object.\n\t\t\t\t\t\t\t\tfor (k in value) {\n\t\t\t\t\t\t\t\t\tif (Object.hasOwnProperty.call(value, k)) {\n\t\t\t\t\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\t\t\t\t\tif (v) {\n\t\t\t\t\t\t\t\t\t\t\tpartial.push(quote(k) + (gap ? ': ' : ':') + v);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Join all of the member texts together, separated with commas,\n\t\t\t\t\t\t\t// and wrap them in braces.\n\t\t\t\t\t\t\tv = partial.length === 0 ? '{}' : gap ? '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + '}' : '{' + partial.join(',') + '}';\n\t\t\t\t\t\t\tgap = mind;\n\t\t\t\t\t\t\treturn v;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn function(value, replacer, space){\n\t\t\t\t\tif(window.JSON && window.JSON.stringify){\n\t\t\t\t\t\treturn window.JSON.stringify(value, replacer, space);\n\t\t\t\t\t}\n\t\t\t\t\t// The stringify method takes a value and an optional replacer, and an optional\n\t\t\t\t\t// space parameter, and returns a JSON text. The replacer can be a function\n\t\t\t\t\t// that can replace values, or an array of strings that will select the keys.\n\t\t\t\t\t// A default replacer method can be provided. Use of the space parameter can\n\t\t\t\t\t// produce text that is more easily readable.\n\t\t\t\t\tvar i;\n\t\t\t\t\tgap = '';\n\t\t\t\t\tindent = '';\n\t\t\t\t\t\n\t\t\t\t\t// If the space parameter is a number, make an indent string containing that\n\t\t\t\t\t// many spaces.\n\t\t\t\t\tif (typeof space === 'number') {\n\t\t\t\t\t\tfor (i = 0; i < space; i += 1) {\n\t\t\t\t\t\t\tindent += ' ';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// If the space parameter is a string, it will be used as the indent string.\n\t\t\t\t\t}\n\t\t\t\t\telse \n\t\t\t\t\t\tif (typeof space === 'string') {\n\t\t\t\t\t\t\tindent = space;\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// If there is a replacer, it must be a function or an array.\n\t\t\t\t\t// Otherwise, throw an error.\n\t\t\t\t\trep = replacer;\n\t\t\t\t\tif (replacer && typeof replacer !== 'function' && (typeof replacer !== 'object' || typeof replacer.length !== 'number')) {\n\t\t\t\t\t\tthrow new Error('JSON.stringify');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Make a fake root object containing our value under the key of ''.\n\t\t\t\t\t// Return the result of stringifying the value.\n\t\t\t\t\treturn str('', {\n\t\t\t\t\t\t'': value\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t})(),\n\t\tstr2json: function(str){\n\t\t\ttry{\n\t\t\t\treturn eval('('+str+')');\n\t\t\t}catch(e){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tgetUrlParam: function(name){\n\t\t\tvar reg = new RegExp(\"(^|&)\"+ name +\"=([^&]*)(&|$)\"); //构造一个含有目标参数的正则表达式对象.\n\t\t\tvar r = window.location.search.substr(1).match(reg);  //匹配目标参数\n\t\t\tif (r!=null){ \n\t\t\t\treturn unescape(r[2]);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tvar iframeConnect = function(){\n\t\tvar cidList = {};\n\t\tvar event = {};\n\t\tvar iid = window.name;\n\n\t\tvar post = function(cid, cmd, param){\t\t\t\n\t\t\t//iid    iframe的id \t\t\t\n\t\t\t//cid    这个任务的id\n\t\t\t//cmd    clinet段调用回调函数的方法名\n\t\t\t//param  这个任务的参数 数组\n\t\t\tvar msg = utils.json2str(param === undefined ? {iid: iid, cid: cid, cmd: cmd} : {iid: iid, cid: cid, cmd: cmd, param: param});\n\t\t\tif(window.parent.postMessage){\n\t\t\t\twindow.parent.postMessage(msg ,'*');\n\t\t\t}else{\n\t\t\t\twindow.navigator['STK_IFRAME_CONNECT_OUT'](msg);\n\t\t\t}\n\t\t};\n\t\tvar listener = function(evt){\n\t\t\ttry{\n\t\t\t\tvar data = utils.str2json(evt.data);\n\t\t\t\tif(data.cid && data.cid == '_EVENT_'){\n\t\t\t\t\tcEvt.define(event, data.call);\n\t\t\t\t\tcEvt.fire(event, data.call, data.rs);\n\t\t\t\t}\n\t\t\t\telse if(data.cid && data.cid in cidList){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar call = data.call == 'callback' ? cidList[data.cid] : cidList[data.cid][data.call];\n\t\t\t\t\t\tcall(data.rs);\n\t\t\t\t\t\tdelete cidList[data.cid];\n\t\t\t\t\t}catch(e){}\n\t\t\t\t}\n\t\t\t}catch(e){}\n\t\t}\n\n\t\tif(window.postMessage){\n\t\t\tif(window.addEventListener){\n\t\t\t\twindow.addEventListener('message', listener ,false);\n\t\t\t}else{\n\t\t\t\twindow.attachEvent('onmessage', listener);\n\t\t\t}\t\t\t\n\t\t}else{\t\t\t\n\t\t\twindow.navigator['STK_IFRAME_CONNECT_'+iid] = function(data){ listener({ data: data }) };\t\t\t\n\t\t}\n\n\t\treturn {\n\t\t\ttrigger: function(cmd, param, callback){\n\t\t\t\tif((typeof param).toUpperCase() === 'FUNCTION'){\n\t\t\t\t\tcallback = param;\n\t\t\t\t\tparam = undefined;\n\t\t\t\t}\n\t\t\t\tvar cid = utils.getUniqueKey();\n\t\t\t\tcallback && (cidList[cid] = callback);\n\t\t\t\tpost(cid, cmd, param);\n\t\t\t},\n\t\t\ton: function(cmd, fn){\n\t\t\t\tcEvt.define(event, cmd);\n\t\t\t\tcEvt.add(event, cmd, fn);\n\t\t\t},\n\t\t\toff: function(cmd, fn){\n\t\t\t\tcEvt.remove(event, cmd, fn);\n\t\t\t}\n\t\t};\n\t};\n\n\t//兼容原来的api\n\tvar iconnect = window.iconnect = iframeConnect();\n\twindow.iframeConnect = function(){\n\t\treturn iconnect;\n\t};\n\ticonnect.setHeight = function(num, callback){\n\t\ticonnect.trigger('setHeight', num, callback);\n\t};\n\ticonnect.getLayoutInfo = function(callback){\n\t\ticonnect.trigger('getLayoutInfo', callback);\n\t};\n\ticonnect.oauth = function(options){\n\t\tif(options.appkey == null || options.callback == null){\n\t\t\treturn;\n\t\t}\n\t\tvar doc = document, iframe_id = \"page_app_oauth_iframe\";\n\t\tvar url = \"https://api.weibo.com/2/oauth2/authorize?client_id=\" + options.appkey\n\t\t\t\t\t + \"&response_type=code&redirect_uri=\" + encodeURIComponent(options.callback) + \"&quick_auth=true\";\n\t\tif(doc.getElementById(iframe_id) == null){\n\t\t\tvar iframe = doc.createElement('iframe');\n\t\t\tiframe.id = iframe_id;\n\t\t\t// iframe.setAttribute(\"style\", \"position:absolute;left:-1000px;top:-1000px;display:none\");\n\t\t\tiframe.style.cssText = \"position:absolute;left:-1000px;top:-1000px;display:none\";\n\t\t\tiframe.src = url;\n\t\t\tdocument.body.appendChild(iframe);\n\t\t} else {\n\t\t\tdoc.getElementById(iframe_id).src = url;\t\n\t\t}\n\t};\n})(window, document);\n\n\n\n\n"]}