{"version":3,"sources":["../../../src/dom-helper/dom/animation.js"],"names":["emptyFunction","process","env","BROWSER","prefix","eventPrefix","vendors","Webkit","Moz","O","testEl","document","createElement","supportedAnimation","supportedTransforms","cssReset","transform","supportedHWCompositing","transitionEnd","animationEnd","transitionProperty","transitionOrigin","transitionDuration","transitionTiming","transitionDelay","animationName","animationDuration","animationTiming","animationDelay","vendor","style","undefined","toLowerCase","perspective","animate","elem","opts","cssValues","ignoreRE","transforms","fired","endEvent","cssProperties","wrappedCallback","property","origin","duration","ease","onComplete","delay","HWCompositing","camelize","str","replace","match","chr","toUpperCase","dasherize","setStyle","node","name","value","maybeAddPx","cssNumber","setProperty","n","hasOwnProperty","parseFloat","key","test","push","join","event","target","currentTarget","removeEventListener","call","addEventListener","setTimeout","transformName"],"mappings":"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","file":"animation.js","sourcesContent":["/**\n * rocket animation function\n * @name animation#animate\n * @function\n * @param {Element} elem - animation element\n * @param {Object} opts\n * @param {Object} opts.property - animation properties\n * @param {String} opts.origin - transition origin\n * @param {Object} opts.duration - transition duration\n * @param {String} opts.ease - transition ease\n * @param {String} opts.delay - animation delay\n * @param {Function} opts.onComplete - animation complete callback\n * @param {*} opts.xx - css attributes need to the element\n * @return {Element} animation element\n * @author MrGalaxyn\n */\nfunction emptyFunction() {}\nexport default process.env.BROWSER ? (function() {\n    var prefix = '', eventPrefix;\n    var vendors = { Webkit: 'webkit', Moz: '', O: 'o' };\n    var testEl = document.createElement('div');\n    var supportedAnimation = true;\n    var supportedTransforms = /^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;\n    var cssReset = {};\n    var transform, supportedHWCompositing, transitionEnd, animationEnd,\n        transitionProperty, transitionOrigin, transitionDuration, \n        transitionTiming, transitionDelay,\n        animationName, animationDuration, animationTiming, animationDelay;\n    for (var vendor in vendors) {\n        if (testEl.style[vendor + 'TransitionProperty'] === undefined) {\n            continue;\n        }\n        prefix = '-' + vendor.toLowerCase() + '-';\n        eventPrefix = vendors[vendor];\n        break;\n    }\n    if (eventPrefix === undefined && \n            testEl.style.transitionProperty === undefined) {\n        supportedAnimation = false;\n    }\n    var perspective = eventPrefix ? eventPrefix + 'Perspective' : 'perspective';\n    supportedHWCompositing = perspective in testEl.style;\n    testEl = null;\n    transform = prefix + 'transform';\n    transitionEnd = eventPrefix ? eventPrefix + 'TransitionEnd' : 'TransitionEnd'.toLowerCase();\n    animationEnd = eventPrefix ? eventPrefix + 'AnimationEnd' : 'AnimationEnd'.toLowerCase();\n    cssReset[transitionOrigin = prefix + 'transition-origin'] =\n    cssReset[transitionProperty = prefix + 'transition-property'] =\n    cssReset[transitionDuration = prefix + 'transition-duration'] =\n    cssReset[transitionDelay = prefix + 'transition-delay'] =\n    cssReset[transitionTiming = prefix + 'transition-timing-function'] = '';\n    cssReset[animationName = prefix + 'animation-name'] =\n    cssReset[animationDuration = prefix + 'animation-duration'] =\n    cssReset[animationDelay = prefix + 'animation-delay'] =\n    cssReset[animationTiming = prefix + 'animation-timing-function'] = '';\n\n    function animate(elem, opts) {\n        let cssValues = {};\n        let ignoreRE = /HWCompositing|property|origin|duration|ease|onComplete|delay/;\n        let transforms = '';\n        let fired = false;\n        let endEvent, cssProperties, wrappedCallback;\n\n        opts = Object.assign({\n            property: \"\",\n            origin: '',\n            duration: 400,\n            ease: 'linear',\n            onComplete: () => {},\n            delay: 0,\n            HWCompositing: false\n        }, opts);\n\n        function camelize(str) {\n            return str.replace(/-+(.)?/g, function(match, chr) {\n                return chr ? chr.toUpperCase() : '';\n            });\n        }\n\n        function dasherize(str) {\n            return str.replace(/::/g, '/')\n                   .replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2')\n                   .replace(/([a-z\\d])([A-Z])/g, '$1_$2')\n                   .replace(/_/g, '-')\n                   .toLowerCase();\n        }\n\n        function setStyle(node, name, value) {\n            function maybeAddPx(name, value) {\n                return (typeof value == \"number\" && !cssNumber[dasherize(name)]) ?\n                        value + \"px\" : value\n            }\n\n            if (typeof name == \"string\") {\n                if (!value && value !== 0) \n                    node.style.setProperty(dasherize(name), value)\n                else\n                    node.style[camelize(name)] = maybeAddPx(name, value);\n            } else if (typeof name == \"object\") {\n                for (var n in name) {\n                    if (name.hasOwnProperty(n)) {\n                        if (!name[n] && name[n] !== 0)\n                            node.style.setProperty(dasherize(n), name[n])\n                        else\n                            node.style[camelize(n)] = maybeAddPx(n, name[n]);\n                    }\n                }\n            }\n        }\n\n        if (!supportedAnimation) opts.duration = 0;\n        if (opts.property && typeof opts.property === 'string') {\n            // keyframe animation\n            cssValues[animationName] = opts.property;\n            cssValues[animationDuration] = parseFloat(opts.duration) / 1000 + 's';\n            cssValues[animationDelay] = parseFloat(opts.delay) / 1000 + 's';\n            cssValues[animationTiming] = opts.ease;\n            endEvent = animationEnd;\n        } else {\n            cssProperties = [];\n            endEvent = transitionEnd;\n            // CSS transitions\n            for (var key in opts) {\n                if (ignoreRE.test(key)) continue;\n                if (supportedTransforms.test(key)) {\n                    transforms += key + '(' + opts[key] + ') ';\n                } else {\n                    cssValues[key] = opts[key];\n                    cssProperties.push(dasherize(key));\n                }\n            }\n            // hardware compositing, may have bug with some mobile like SUMSANG NOTE3\n            if (opts.HWCompositing && !/translate(Z|3d)|matrix3d/.test(transforms) && supportedHWCompositing) {\n                transforms += 'translateZ(0px)';\n            }\n            if (transforms) {\n                cssValues[transform] = transforms;\n                cssProperties.push(transform);\n            }\n\n            if (opts.origin && typeof opts.origin === 'string') {\n                cssValues[transitionOrigin] = opts.origin;\n            }\n            if (opts.duration > 0) {\n                cssValues[transitionProperty] = cssProperties.join(', ');\n                cssValues[transitionDuration] = parseFloat(opts.duration) / 1000 + 's';\n                cssValues[transitionDelay] = parseFloat(opts.delay) / 1000 + 's';\n                cssValues[transitionTiming] = opts.ease;\n            }\n        }\n        wrappedCallback = function(event) {\n            if (typeof event !== 'undefined') {\n                // makes sure the event didn't bubble from \"below\"\n                if (event.target !== event.currentTarget) return;\n                elem.removeEventListener(endEvent, wrappedCallback);\n            } else if (opts.duration > 0) {\n                // triggered by setTimeout\n                elem.removeEventListener(endEvent, wrappedCallback);\n            }\n\n            fired = true;\n            setStyle(elem, cssReset);\n            opts.onComplete && opts.onComplete.call(elem);\n        };\n\n        if (opts.duration > 0) {\n            elem.addEventListener(endEvent, wrappedCallback)\n            // transitionEnd is not always firing on older Android phones\n            // so make sure it gets fired\n            setTimeout(function() {\n                if (fired) return;\n                wrappedCallback.call(elem);\n            }, opts.duration + opts.delay + 25);\n        }\n\n        setStyle(elem, cssValues);\n        if (opts.duration <= 0) {\n            setTimeout(function() {\n                wrappedCallback.call(elem);\n            }, 0);\n        }\n        \n        return elem;\n    };\n    return {\n        animate: animate,\n        transformName: transform\n    }\n})() : { animate: emptyFunction, transformName: 'transform' };\n"]}